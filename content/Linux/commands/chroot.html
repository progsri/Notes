<h2> <b> chroot </b> </h2>	
<hr>	

<p>	
  chroot	
</p>	

<br>
<h4> <b> Example </b> </h4>	
<pre class="language-shell line-numbers"><code>	

#Create a directory for that would be the new root.	
progsri@machine:~/Desktop$ mkdir chroot	

</code></pre>	

<p>	
Since we need a sheel for the process to run, let say bash, we need to copy the binary and it's dependencies into the new	
root directory.	
</p>	

Use <code> ldd </code> to get all the dependencies for <code> bash </code>  binary.	
<pre class="language-shell line-numbers"><code>	
ldd /bin/bash	
	linux-vdso.so.1 (0x00007ffdc9fa9000)	
	libtinfo.so.6 => /lib/x86_64-linux-gnu/libtinfo.so.6 (0x00007f9d81990000)	
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f9d8198a000)	
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f9d81798000)	
	/lib64/ld-linux-x86-64.so.2 (0x00007f9d81b0e000)	

</code></pre>	

<pre class="language-shell line-numbers"><code>	
cd /home/progsri/Desktop/chroot	
mkdir bin	
mkdir lib	
mkdir lib64	
</code></pre>	

<p>	
  copy the /bin/bash and all the libraries (dependencies) into the new bin,lib,lib64 directories in the new root.	
</p>	
<p>	
  Create the new root using <code> chroot </code>	
</p>	
<pre class="language-shell line-numbers"><code>	
progsri@machine:~/Desktop/chroot$ pwd	
/home/progsri/Desktop/chroot	
progsri@machine:~/Desktop/chroot$ sudo chroot ./ /bin/bash	
bash-5.0#	
</code></pre>	

<p>	
   Inside the new root only bash will be available and the other commands that come with the bash sheel such as <code> pwd 	
   </code>, <code> echo </code>, <code> kill </code> . To find the list of available code that are in built use <code> help 	
   </code> as seen below	
<p>
<img src="./images/sheel_inbuilt.png" width="800" height="600">
	
<hr>
<h4> <b> New commmands </b> </h4>
<p> Let us try to list inside the chroot <p>
	
<pre class="language-shell line-numbers"><code>	
bash-5.0# ls
bash: ls: command not found
</code></pre>	
<p> Observe the ls command is not found inside the chroot as we have not copied it</p>

<pre class="language-shell line-numbers"><code>	
ldd /bin/ls
	linux-vdso.so.1 (0x00007fff50fe0000)
	libselinux.so.1 => /lib/x86_64-linux-gnu/libselinux.so.1 (0x00007f4a12461000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f4a1226f000)
	libpcre2-8.so.0 => /usr/lib/x86_64-linux-gnu/libpcre2-8.so.0 (0x00007f4a121df000)
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f4a121d9000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f4a124d3000)
	libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f4a121b6000)
	
copy all these to lib or lib64
</code></pre>	

<pre class="language-shell line-numbers"><code>	
cp /bin/ls ~/Desktop/chroot/bin
sudo chroot ~/Desktop/chroot/ /bin/bash
bash-5.0# ls
bin  lib  lib64
</code></pre>	


<hr>
<h4> <b> Chrooted user </b> </h4>	
https://www.tecmint.com/restrict-ssh-user-to-directory-using-chrooted-jail/

<hr>
<h4> <b> Chrooted Process </b> </h4>
you will need to login using a ssh which will use ChrootDirectory and then you can execute the process.

<hr>
<h4> <b> Chrooted Process and networking </b> </h4>
http://www.tcu-inc.com/Articles/23/chroot.html

